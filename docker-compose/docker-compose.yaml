services:
  app:
    image: ${IMAGE_TAG}
    # for latest image versios see https://hub.docker.com/r/diadata/decentralized-feeder/tags
    env_file:
      - .env
    restart: always
    volumes:
      - /absolute/path/to/your/local/repo:/app/repository  # Mount your local repo in the container
    deploy:
      resources:
        limits:
          memory: 2G
      restart_policy:
        condition: on-failure
        max_attempts: 3
        window: 120s
    stop_grace_period: 30s
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9090/metrics"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
